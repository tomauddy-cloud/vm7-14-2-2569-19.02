<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏±‡∏ï‡∏ß‡πå ‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
body { font-family: "Sarabun", Arial, sans-serif; background:#f4f6fb; margin:0; }
header { background:#fff; padding:20px; text-align:center; border-bottom:4px solid #2c3e90; }
main { max-width:900px; margin:30px auto; background:#fff; padding:30px; border-radius:10px; box-shadow:0 6px 15px rgba(0,0,0,.1); }
.center-list { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:15px; }
.center-card { border:1px solid #ddd; border-radius:8px; padding:15px; text-align:center; background:#f9fafc; }
.center-card button { margin-top:10px; padding:10px 18px; background:#2c3e90; color:#fff; border:none; border-radius:6px; cursor:pointer; }
label { display:block; margin-top:10px; }
input, select { width:100%; padding:6px; margin-top:4px; }
.pet-card { border:1px solid #ccc; padding:10px; margin-top:10px; border-radius:6px; }
footer { text-align:center; padding:15px; color:#666; font-size:14px; }
</style>
</head>
<body>
<header>
  <div style="display:flex;align-items:center;justify-content:center;gap:20px;flex-wrap:wrap;">
    
    <div style="text-align:center;">
      <div style="border-bottom:2px solid #2c3e90; padding-bottom:10px; margin-bottom:10px;">
        <h1 style="margin:0;font-size:26px;">‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ô‡∏Ñ‡∏£‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ</h1>
        <h2 style="margin:5px 0 0;font-size:20px;font-weight:normal;">‡∏Å‡∏≠‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° ‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç</h2>
      </div>
      <div>
        <h3 style="margin:5px 0 0;font-size:18px;">‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå</h3>
        <p style="margin:0;font-size:16px;">‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏±‡∏ï‡∏ß‡πå ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2569</p>
      </div>
    </div>
  </div>
</header>

<main>
<h2 style="text-align:center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå</h2>
<div class="center-list">
  <div class="center-card">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 1<br><button type="button" onclick="openForm(1)">‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</button></div>
  <div class="center-card">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 2<br><button type="button" onclick="openForm(2)">‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</button></div>
  <div class="center-card">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 3<br><button type="button" onclick="openForm(3)">‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</button></div>
  <div class="center-card">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 4<br><button type="button" onclick="openForm(4)">‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</button></div>
  <div class="center-card">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 5<br><button type="button" onclick="openForm(5)">‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</button></div>
  <div class="center-card">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 6<br><button type="button" onclick="openForm(6)">‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</button></div>
  <div class="center-card">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 7<br><button type="button" onclick="openForm(7)">‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</button></div>
</div>

<div id="formSection" style="display:none; margin-top:40px;">
<h2>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏±‡∏ï‡∏ß‡πå</h2>
<p id="centerLabel" style="font-weight:bold;color:#2c3e90"></p>
<form id="surveyForm">
<input type="hidden" id="centerId"><input type="hidden" id="centerName">

<label>‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
<input type="number" id="year" value="2569" required>

<label>‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</label>
<input type="text" id="community" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏°‡∏ä‡∏ô" required>

<label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå</label>
<select id="animalType" required>
  <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
  <option>‡πÑ‡∏°‡πà‡∏°‡∏µ</option>
  <option>‡∏™‡∏∏‡∏ô‡∏±‡∏Ç</option><option>‡πÅ‡∏°‡∏ß</option><option>‡πÇ‡∏Ñ</option><option>‡πÄ‡∏õ‡πá‡∏î</option><option>‡πÑ‡∏Å‡πà</option><option>‡∏™‡∏∏‡∏Å‡∏£</option><option>‡∏ô‡∏Å</option><option>‡πÅ‡∏û‡∏∞</option><option>‡∏°‡πâ‡∏≤</option><option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏</option>
</select> 

<div id="otherAnimalBox" style="display:none; margin-top:10px;">
  <label>‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡∏™‡∏±‡∏ï‡∏ß‡πå</label>
  <input type="text" id="otherAnimalType" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏£‡∏∞‡∏ï‡πà‡∏≤‡∏¢, ‡πÄ‡∏ï‡πà‡∏≤">

  <label>‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
  <input type="number" id="otherAnimalQty" min="1">
</div>

<div id="petQtyBox">
  <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</label>
  <input type="number" id="petQty" min="0" max="100" value="0">
</div>

<div id="petList"></div>

<h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</h3>
<label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</label>
<input type="text" id="recorderName">

<label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á (13 ‡∏´‡∏•‡∏±‡∏Å)</label>
<input type="text" id="citizenId" maxlength="13" minlength="13" pattern="\d{13}" required>

<label>‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</label><input id="addrNo">
<label>‡∏ñ‡∏ô‡∏ô</label><input id="road">
<label>‡∏ã‡∏≠‡∏¢</label><input id="soi">
<label>‡∏ï‡∏≥‡∏ö‡∏•</label><input id="subdistrict">
<label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label><input id="district">
<label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label><input id="province">

<label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
<input type="text" id="phone">

<button type="submit" style="margin-top:15px;padding:10px 20px;background:#2c3e90;color:#fff;border:none;border-radius:6px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
</form>
<p id="status" style="margin-top:15px;"></p>
</div>
</main>

<footer>¬© ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ô‡∏Ñ‡∏£‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ | ‡∏Å‡∏≠‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° ‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå 045-246060 ‡∏ï‡πà‡∏≠ 180 280</footer>

<script>
function openForm(center) {
  const names = {
    1:'‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 1',
    2:'‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 2',
    3:'‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 3',
    4:'‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 4',
    5:'‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 5',
    6:'‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 6',
    7:'‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà 7'
  };

  document.getElementById('formSection').style.display = 'block';

  // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏•‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå
  document.getElementById('centerId').value = center;
    updateCommunityByCenter(center);

  // ‚≠ê ‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å Sheet)
  document.getElementById('centerName').value = names[center];

  // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
  document.getElementById('centerLabel').innerText =
    '‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + names[center];
}

const petQtyInput = document.getElementById('petQty');
const petList = document.getElementById('petList');
petQtyInput.addEventListener('input', syncPetList);

function syncPetList() {

  const qty = parseInt(petQtyInput.value || 0);
  const type = document.getElementById('animalType')?.value;

  /* ===== ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏™‡∏±‡∏ï‡∏ß‡πå ===== */
  const ownerInput = document.getElementById('recorderName');
  if (qty > 0) {
    ownerInput.required = true;
    ownerInput.placeholder = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
  } else {
    ownerInput.required = false;
    ownerInput.placeholder = '';
  }

  /* ===== ‡∏™‡∏£‡πâ‡∏≤‡∏á / ‡∏•‡∏ö pet-card ‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ===== */
  while (petList.children.length < qty) {
    petList.appendChild(createPetCard(petList.children.length + 1));
  }
  while (petList.children.length > qty) {
    petList.removeChild(petList.lastChild);
  }
}

function toggleRabiesDate(selectEl){
  const card = selectEl.closest('.pet-card');
  const dateInput = card.querySelector('.rabiesDate');
  if(selectEl.value === '‡πÄ‡∏Ñ‡∏¢‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤'){
    dateInput.style.display = 'block';
    dateInput.required = true;
  }else{
    dateInput.style.display = 'none';
    dateInput.required = false;
    dateInput.value = '';
  }
}

function toggleContraceptiveDate(sel){
  const card = sel.closest('.pet-card');
  const date = card.querySelector('.contraceptiveDate');
  if(sel.value==='‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏°'){ date.style.display='block'; date.required=true; }
  else { date.style.display='none'; date.required=false; date.value=''; }
}

function createPetCard(no) {
  const d=document.createElement('div');
  d.className='pet-card';
  d.innerHTML=`<strong>‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà ${no}</strong>
    <input class="petName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå">
    <select class="gender"><option>‡∏ú‡∏π‡πâ</option><option>‡πÄ‡∏°‡∏µ‡∏¢</option><option>‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏</option></select>
    <input type="number" class="ageYear" placeholder="‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)" min="0">
    <input type="number" class="ageMonth" placeholder="‡∏≠‡∏≤‡∏¢‡∏∏ (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)" min="0" max="11">
    <input class="color" placeholder="‡∏™‡∏µ / ‡∏ï‡∏≥‡∏´‡∏ô‡∏¥">
    <select class="sterilization" onchange="toggleContraceptiveDate(this)"><option>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô</option><option>‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option><option>‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏°</option></select>
    <input type="date" class="contraceptiveDate" style="display:none">
    <select class="rabies" onchange="toggleRabiesDate(this)"><option>‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤</option><option>‡πÄ‡∏Ñ‡∏¢‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤</option></select>
    <input type="date" class="rabiesDate" style="display:none" placeholder="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î">
    <select class="raising"><option>‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤</option><option>‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ö‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤</option><option>‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤</option></select>
    <select class="location"><option>‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢</option><option>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</option><option>‡∏ß‡∏±‡∏î</option><option>‡∏ï‡∏•‡∏≤‡∏î</option><option>‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô</option><option>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô</option></select>`;
  return d;
}

 </script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  // ‡∏´‡∏≤ input ‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏£‡∏Å)
  const recorderInput = document.getElementById('recorderName');
  if (!recorderInput) return;

  /* ===== label ‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î ===== */
  const vetLabel = document.createElement('label');
  vetLabel.textContent = '‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î';

  /* ===== select ‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î ===== */
  const vetSelect = document.createElement('select');
  vetSelect.id = 'vetProvider';
  vetSelect.required = true;
  vetSelect.innerHTML = `
    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
    <option value="‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ô‡∏Ñ‡∏£‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ/‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå">‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ô‡∏Ñ‡∏£‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ / ‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå</option>
    <option value="‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å/‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå">‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å / ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå</option>
    <option value="‡∏≠‡∏≤‡∏™‡∏≤‡∏õ‡∏®‡∏∏‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á">‡∏≠‡∏≤‡∏™‡∏≤‡∏õ‡∏®‡∏∏‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á</option>
    <option value="‡∏Ñ‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å">‡∏Ñ‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å</option>
    <option value="‡∏â‡∏µ‡∏î‡πÄ‡∏≠‡∏á">‡∏â‡∏µ‡∏î‡πÄ‡∏≠‡∏á</option>
    <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
  `;

  /* ===== ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô) ===== */
  const vetOtherInput = document.createElement('input');
  vetOtherInput.type = 'text';
  vetOtherInput.id = 'vetProviderOther';
  vetOtherInput.placeholder = '‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå / ‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î';
  vetOtherInput.style.display = 'none';

  /* ===== ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ ===== */
  vetSelect.addEventListener('change', function () {
    if (this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
      vetOtherInput.style.display = 'block';
      vetOtherInput.required = true;
    } else {
      vetOtherInput.style.display = 'none';
      vetOtherInput.required = false;
      vetOtherInput.value = '';
    }
  });

  /* ===== ‡πÅ‡∏ó‡∏£‡∏Å‡∏•‡∏á‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏° ===== */
  recorderInput.insertAdjacentElement('afterend', vetOtherInput);
  recorderInput.insertAdjacentElement('afterend', vetSelect);
  recorderInput.insertAdjacentElement('afterend', vetLabel);

});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  /* 1) ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ label */
  document.querySelectorAll('label').forEach(label => {
    if (label.textContent.trim() === '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á') {
      label.textContent = '‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / ‡∏ú‡∏π‡πâ‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
    }
  });

  /* 2) ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á */
  const recorderInput = document.getElementById('recorderName');
  const phoneInput = document.getElementById('phone');

  if (recorderInput) {
    const roleLabel = document.createElement('label');
    roleLabel.textContent = '‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á';

    const roleSelect = document.createElement('select');
    roleSelect.id = 'recorderRole';
    roleSelect.required = true;
    roleSelect.innerHTML = `
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á --</option>
      <option>‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</option>
      <option>‡∏≠‡∏™‡∏°.</option>
    `;

    recorderInput.insertAdjacentElement('afterend', roleSelect);
    roleSelect.insertAdjacentElement('beforebegin', roleLabel);

    /* 3) ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏≠‡∏™‡∏°. ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ */
    roleSelect.addEventListener('change', function () {
      if (!phoneInput) return;

      if (this.value === '‡∏≠‡∏™‡∏°.') {
        phoneInput.required = true;
        phoneInput.placeholder = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏≠‡∏™‡∏°.)';
      } else {
        phoneInput.required = false;
        phoneInput.placeholder = '';
      }
    });
  }

});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const citizenInput = document.getElementById('citizenId');
  if (!citizenInput) return;

  /* ‡πÑ‡∏•‡πà‡∏¢‡πâ‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡∏•‡∏ö label + select + input ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î */
  let el = citizenInput.previousElementSibling;

  while (el) {
    // 
    if (el.tagName === 'LABEL' && el.textContent.includes('‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î')) {
      const select = el.nextElementSibling;
      const otherInput = select && select.nextElementSibling;

      if (select && select.tagName === 'SELECT') select.remove();
      if (otherInput && otherInput.tagName === 'INPUT') otherInput.remove();

      el.remove();
      break;
    }

    el = el.previousElementSibling;
  }

});
</script>
<script>
document.addEventListener('change', function (e) {

  /* ---------- ‡∏Å‡∏£‡∏ì‡∏µ ‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏° ---------- */
  if (e.target.classList.contains('sterilization')) {
    const card = e.target.closest('.pet-card');
    let box = card.querySelector('.contraceptiveVetBox');

    if (e.target.value === '‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏°') {
      if (!box) {
        box = createVetBox('‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏°');
        box.classList.add('contraceptiveVetBox');
        e.target.insertAdjacentElement('afterend', box);
      }
      box.style.display = 'block';
    } else {
      if (box) box.style.display = 'none';
    }
  }

  /* ---------- ‡∏Å‡∏£‡∏ì‡∏µ ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤ ---------- */
  if (e.target.classList.contains('rabies')) {
    const card = e.target.closest('.pet-card');
    let box = card.querySelector('.rabiesVetBox');

    if (e.target.value === '‡πÄ‡∏Ñ‡∏¢‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤') {
      if (!box) {
        box = createVetBox('‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤');
        box.classList.add('rabiesVetBox');
        e.target.insertAdjacentElement('afterend', box);
      }
      box.style.display = 'block';
    } else {
      if (box) box.style.display = 'none';
    }
  }

});

/* ---------- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î ---------- */
function createVetBox(labelText) {
  const wrap = document.createElement('div');
  wrap.style.marginTop = '6px';

  wrap.innerHTML = `
    <label>${labelText}</label>
    <select class="vetSource">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
      <option>‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ô‡∏Ñ‡∏£‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ / ‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå</option>
      <option>‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å / ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå</option>
      <option>‡∏≠‡∏≤‡∏™‡∏≤‡∏õ‡∏®‡∏∏‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á</option>
      <option>‡∏Ñ‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å</option>
      <option>‡∏â‡∏µ‡∏î‡πÄ‡∏≠‡∏á</option>
      <option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
    </select>
    <input type="text" class="vetName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå / ‡∏ú‡∏π‡πâ‡∏â‡∏µ‡∏î" style="display:none">
  `;

  const select = wrap.querySelector('.vetSource');
  const input = wrap.querySelector('.vetName');

  select.addEventListener('change', function () {
    if (this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
      input.style.display = 'block';
      input.required = true;
    } else {
      input.style.display = 'none';
      input.required = false;
      input.value = '';
    }
  });

  return wrap;
}
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const roleSelect = document.getElementById('recorderRole');
  const phoneInput = document.getElementById('phone');
  const centerIdInput = document.getElementById('centerId');

  if (!roleSelect) return;

  /* ‡∏•‡πâ‡∏≤‡∏á option ‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà */
  roleSelect.innerHTML = `
    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á --</option>
    <option>‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</option>
  `;

  /* ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏≠‡∏™‡∏°. ‡∏ï‡∏≤‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå 1 - 7 */
  for (let i = 1; i <= 7; i++) {
    const opt = document.createElement('option');
    opt.value = `‡∏≠‡∏™‡∏°.‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà ${i}`;
    opt.textContent = `‡∏≠‡∏™‡∏°.‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ó‡∏µ‡πà ${i}`;
    roleSelect.appendChild(opt);
  }

  /* ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏≠‡∏™‡∏°. ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ */
  roleSelect.addEventListener('change', function () {
    if (!phoneInput) return;

    if (this.value.startsWith('‡∏≠‡∏™‡∏°.‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç')) {
      phoneInput.required = true;
      phoneInput.placeholder = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏≠‡∏™‡∏°.)';
    } else {
      phoneInput.required = false;
      phoneInput.placeholder = '';
    }
  });

});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const phoneInput = document.getElementById('phone');
  if (!phoneInput) return;

  /* ===== label ===== */
  const label = document.createElement('label');
  label.innerHTML = '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á <span style="color:red">*</span>';

  /* ===== select ===== */
  const select = document.createElement('select');
  select.id = 'raisingPlace';
  select.required = true;
  select.style.display = 'block';
  select.style.marginTop = '6px';

  select.innerHTML = `
    <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á --</option>
    <option value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå">
      ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå
    </option>
    <option value="‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå">
      ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå
    </option>
    <option value="‡πÑ‡∏°‡πà‡∏°‡∏µ">
      ‡πÑ‡∏°‡πà‡∏°‡∏µ
    </option>
  `;

  phoneInput.insertAdjacentElement('afterend', select);
  select.insertAdjacentElement('beforebegin', label);

});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const citizenInput = document.getElementById('citizenId');
  if (!citizenInput) return;

  /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≥ */
  if (document.getElementById('ownerInfoTitle')) return;

  const ownerTitle = document.createElement('h3');
  ownerTitle.id = 'ownerInfoTitle';
  ownerTitle.textContent = '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå';

  /* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏î‡∏≥ */
  ownerTitle.style.marginTop = '20px';
  ownerTitle.style.color = '#000';

  const citizenLabel = citizenInput.previousElementSibling;
  if (citizenLabel && citizenLabel.tagName === 'LABEL') {
    citizenLabel.insertAdjacentElement('beforebegin', ownerTitle);
  }

});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const header = document.querySelector('header');
  if (!header) return;

  /* ‡πÄ‡∏û‡∏¥‡πà‡∏° style responsive */
  const style = document.createElement('style');
  style.textContent = `
    @media (max-width: 600px) {

      header {
        padding: 15px 10px;
      }

      header h1 {
        font-size: 20px !important;
      }

      header h2 {
        font-size: 16px !important;
      }

      header h3 {
        font-size: 16px !important;
      }

      header p {
        font-size: 14px !important;
      }

    }
  `;
  document.head.appendChild(style);

});
</script>
<script>
(function () {

  const GAS_URL = "https://script.google.com/macros/s/AKfycbyqaslf8zT6R7wJ8IwxJ6EPEIEqW8dwtlhoLAGPzmaGp8DKUe-WDXb7jEJ77Jv8dFcN/exec";

  const form = document.getElementById('surveyForm');
  if (!form) return;

  form.addEventListener('submit', async function (e) {
    e.preventDefault();

    /* ---------- ‡∏™‡∏±‡∏ï‡∏ß‡πå ---------- */
    let pets = [];
    if (document.getElementById('animalType').value !== '‡πÑ‡∏°‡πà‡∏°‡∏µ') {
      pets = [...document.querySelectorAll('.pet-card')].map((card, i) => {

        const getVet = (box) => {
          if (!box) return '';
          const src = box.querySelector('.vetSource')?.value || '';
          const name = box.querySelector('.vetName')?.value || '';
          return src === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? name : src;
        };

        return {
          no: i + 1,
          name: card.querySelector('.petName')?.value || '',
          gender: card.querySelector('.gender')?.value || '',
          ageYear: card.querySelector('.ageYear')?.value || '',
          ageMonth: card.querySelector('.ageMonth')?.value || '',
          color: card.querySelector('.color')?.value || '',
          sterilization: card.querySelector('.sterilization')?.value || '',
          contraceptiveDate: card.querySelector('.contraceptiveDate')?.value || '',
          contraceptiveVet: getVet(card.querySelector('.contraceptiveVetBox')),
          rabies: card.querySelector('.rabies')?.value || '',
          rabiesDate: card.querySelector('.rabiesDate')?.value || '',
          rabiesVet: getVet(card.querySelector('.rabiesVetBox')),
          raisingStyle: card.querySelector('.raising')?.value || '',
                    raisingLocation: card.querySelector('.location')?.value || ''

        };
      });
    }

    /* ---------- payload ---------- */
    const payload = {
  timestamp: new Date().toISOString(),
  centerId: document.getElementById('centerId')?.value || '',
  centerName: document.getElementById('centerName')?.value || '',
  year: document.getElementById('year')?.value || '',
  community: document.getElementById('community')?.value || '',
  animalType: document.getElementById('animalType')?.value || '',

  otherAnimalType: document.getElementById('otherAnimalType')?.value || '',
  otherAnimalQty: document.getElementById('otherAnimalQty')?.value || '',

  ownerName: document.getElementById('recorderName')?.value || '',
  recorderName: document.getElementById('recorderName')?.value || '',
  recorderRole: document.getElementById('recorderRole')?.value || '',

  citizenId: document.getElementById('citizenId')?.value || '',
  phone: document.getElementById('phone')?.value || '',
  homePhone: document.getElementById('homePhone')?.value || '',

  /* üî• ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ */
  raisingArea: document.getElementById('raisingPlace')?.value || '',

  address: {
    addrNo: document.getElementById('addrNo')?.value || '',
    road: document.getElementById('road')?.value || '',
    soi: document.getElementById('soi')?.value || '',
    subdistrict: document.getElementById('subdistrict')?.value || '',
    district: document.getElementById('district')?.value || '',
    province: document.getElementById('province')?.value || ''
  },

  pets: pets
};

    document.getElementById('status').innerText = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';

    try {
      const res = await fetch(GAS_URL, {
        method: 'POST',
        body: JSON.stringify(payload) // ‚≠ê ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏™‡πà headers
      });

      const result = JSON.parse(await res.text());

      if (result.status === 'success') {
        document.getElementById('status').innerText =
          '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheet ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢';

        form.reset();
        document.getElementById('petList').innerHTML = '';
        document.getElementById('petQty').value = 0;

      } else {
        document.getElementById('status').innerText =
          '‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + (result.message || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏');
        console.error(result);
      }

    } catch (err) {
      console.error(err);
      document.getElementById('status').innerText =
        '‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Script';
    }

  });

})();
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const phoneInput = document.getElementById('phone');
  if (!phoneInput) return;

  /* ===== label ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ö‡πâ‡∏≤‡∏ô ===== */
  const homePhoneLabel = document.createElement('label');
  homePhoneLabel.textContent = '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ö‡πâ‡∏≤‡∏ô';

  /* ===== input ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ö‡πâ‡∏≤‡∏ô ===== */
  const homePhoneInput = document.createElement('input');
  homePhoneInput.type = 'text';
  homePhoneInput.id = 'homePhone';
  homePhoneInput.placeholder = '‡πÄ‡∏ä‡πà‡∏ô 045-123456';
  homePhoneInput.pattern = '[0-9\\-]+';

  /* ===== ‡πÅ‡∏ó‡∏£‡∏Å‡πÉ‡∏ï‡πâ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ===== */
  phoneInput.insertAdjacentElement('afterend', homePhoneInput);
  homePhoneInput.insertAdjacentElement('beforebegin', homePhoneLabel);

});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const communityInput = document.getElementById('community');
  if (!communityInput) return;

  /* ===== ‡∏™‡∏£‡πâ‡∏≤‡∏á select ===== */
  const communitySelect = document.createElement('select');
  communitySelect.id = 'communitySelect';
  communitySelect.style.display = 'none';
  communitySelect.required = true;

  /* ===== ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå ===== */
  const communitiesByCenter = {

    1: [
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡πÑ‡∏ä‡∏¢‡∏°‡∏á‡∏Ñ‡∏•',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏™‡∏∏‡∏õ‡∏±‡∏è‡∏ô‡πå',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏±‡∏ï‡∏ô‡∏≤‡∏£‡∏≤‡∏°',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏®‡∏≤‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏≠‡∏∏‡∏ö‡∏•',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏ó‡∏∏‡πà‡∏á‡∏®‡∏£‡∏µ‡πÄ‡∏°‡∏∑‡∏≠‡∏á 1',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏ó‡∏∏‡πà‡∏á‡∏®‡∏£‡∏µ‡πÄ‡∏°‡∏∑‡∏≠‡∏á 2',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏´‡∏•‡∏ß‡∏á 1',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏´‡∏•‡∏ß‡∏á 2',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡πÄ‡∏•‡∏µ‡∏¢‡∏ö 1',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡πÄ‡∏•‡∏µ‡∏¢‡∏ö 2',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ö‡∏π‡∏£‡∏û‡∏≤ 1',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ö‡∏π‡∏£‡∏û‡∏≤ 2'
    ],

    2: [
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡πâ‡∏≤‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á 1',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡πâ‡∏≤‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á 2',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡πâ‡∏≤‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á 3',
      '‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß 1',
            '‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß 2',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏• 2 ‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏•‡∏µ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ 1',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏•‡∏µ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ 2',
      '‡∏®‡∏≤‡∏•‡∏≤‡∏´‡∏ô‡∏≠‡∏á‡∏ô‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏¢ 1',
      '‡∏®‡∏≤‡∏•‡∏≤‡∏´‡∏ô‡∏≠‡∏á‡∏ô‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏¢ 2',
      '‡∏ß‡∏±‡∏î‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏¢ 1',
      '‡∏ß‡∏±‡∏î‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏¢ 2',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏≠‡∏∏‡∏ö‡∏• 1',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏≠‡∏∏‡∏ö‡∏• 2'
    ],

    3: [
      '‡∏ñ‡∏ô‡∏ô‡∏û‡∏ô‡∏° 1',
      '‡∏ñ‡∏ô‡∏ô‡∏û‡∏ô‡∏° 2',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ö‡πá‡∏ç‡∏à‡∏∞‡∏°‡∏∞ 3',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ö‡πá‡∏ç‡∏à‡∏∞‡∏°‡∏∞ 4',
      '‡∏ß‡∏±‡∏î‡∏ó‡πà‡∏≤‡∏ß‡∏±‡∏á‡∏´‡∏¥‡∏ô',
      '‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏¢‡∏≤‡∏ß‡πÄ‡∏£‡∏® 1',
      '‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏¢‡∏≤‡∏ß‡πÄ‡∏£‡∏® 2',
      '‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏¢‡∏≤‡∏ß‡πÄ‡∏£‡∏® 3',
      '‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏¢‡∏≤‡∏ß‡πÄ‡∏£‡∏® 4',
      '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏Ø',
      '‡∏ß‡∏±‡∏î‡πÇ‡∏£‡∏°‡∏±‡∏ô‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏•‡∏¥‡∏Ñ',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏µ 3',
      '‡∏ß‡∏±‡∏î‡∏Å‡∏∏‡∏î‡∏Ñ‡∏π‡∏ì',
      '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏™‡∏≤‡∏£‡∏û‡∏±‡∏î‡∏ä‡πà‡∏≤‡∏á'
    ],

    4: [
      '‡∏ß‡∏±‡∏î‡∏û‡∏•‡πÅ‡∏û‡∏ô',
      '‡∏ï‡∏•‡∏≤‡∏î‡∏™‡∏î‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏• 5',
      '‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏π‡πà 1',
      '‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏π‡πà 2',
      '‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏π‡πà 3',
      '‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏π‡πà 4',
      '‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏õ‡∏£‡∏∞‡∏î‡∏π‡πà 1',
      '‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏õ‡∏£‡∏∞‡∏î‡∏π‡πà 2',
      '‡∏ß‡∏±‡∏î‡∏ö‡∏π‡∏£‡∏û‡∏≤ 1',
      '‡∏ß‡∏±‡∏î‡∏ö‡∏π‡∏£‡∏û‡∏≤ 2',
      '‡∏ß‡∏±‡∏î‡∏ö‡∏π‡∏£‡∏û‡∏≤ 3',
      '‡∏ß‡∏±‡∏î‡πÄ‡∏•‡∏µ‡∏¢‡∏ö 3'
    ],

    5: [
      '‡∏ß‡∏±‡∏á‡∏ó‡∏≠‡∏á',
      '‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡πÅ‡∏™‡∏á‡∏ó‡∏≠‡∏á',
      '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£ 1',
      '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£ 2',
      '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£ 3',
      '‡∏î‡∏≠‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏õ‡∏π‡πà‡∏ó‡∏≠‡∏á‡πÅ‡∏î‡∏á 1',
      '‡∏î‡∏≠‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏õ‡∏π‡πà‡∏ó‡∏≠‡∏á‡πÅ‡∏î‡∏á 2',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£ 1',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£ 2',
      '‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î',
      '‡∏≠‡∏∏‡∏õ‡∏•‡∏µ‡∏™‡∏≤‡∏ô 6',
      '‡∏ß‡∏±‡∏î‡∏™‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏∂‡∏Å 1',
      '‡∏ß‡∏±‡∏î‡∏™‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏∂‡∏Å 2',
      '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
      '‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡∏à‡∏±‡∏Å‡∏£'
    ],

    6: [
      '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥ 1',
      '‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥ 2',
      '‡∏ß‡∏±‡∏î‡∏õ‡πà‡∏≤‡πÅ‡∏™‡∏ô‡∏≠‡∏∏‡∏î‡∏° 1',
      '‡∏ß‡∏±‡∏î‡∏õ‡πà‡∏≤‡πÅ‡∏™‡∏ô‡∏≠‡∏∏‡∏î‡∏° 2',
      '‡∏ß‡∏±‡∏î‡∏õ‡πà‡∏≤‡πÅ‡∏™‡∏ô‡∏≠‡∏∏‡∏î‡∏° 3',
      '‡∏ï‡πâ‡∏ô‡∏ã‡∏≠‡∏¢‡∏™‡∏∏‡∏Ç‡∏≤‡∏≠‡∏∏‡∏õ‡∏ñ‡∏±‡∏°‡∏†‡πå 11',
      '‡∏ó‡πâ‡∏≤‡∏¢‡∏ã‡∏≠‡∏¢‡∏™‡∏∏‡∏Ç‡∏≤‡∏≠‡∏∏‡∏õ‡∏ñ‡∏±‡∏°‡∏†‡πå 11',
      '‡∏û‡∏£‡∏∞‡∏®‡∏£‡∏µ‡∏°‡∏´‡∏≤‡πÇ‡∏û‡∏ò‡∏¥‡πå 1',
      '‡∏û‡∏£‡∏∞‡∏®‡∏£‡∏µ‡∏°‡∏´‡∏≤‡πÇ‡∏û‡∏ò‡∏¥‡πå 2'
    ],

    7: [
      '‡∏™‡∏ô‡∏≤‡∏°‡∏Å‡∏µ‡∏¨‡∏≤‡∏Å‡∏•‡∏≤‡∏á 1',
      '‡∏™‡∏ô‡∏≤‡∏°‡∏Å‡∏µ‡∏¨‡∏≤‡∏Å‡∏•‡∏≤‡∏á 2',
      '‡∏™‡∏ô‡∏≤‡∏°‡∏Å‡∏µ‡∏¨‡∏≤‡∏Å‡∏•‡∏≤‡∏á 3',
      '‡∏ä‡∏¢‡∏≤‡∏á‡∏Å‡∏π‡∏£ 2.1 (1)',
      '‡∏ä‡∏¢‡∏≤‡∏á‡∏Å‡∏π‡∏£ 2.1 (2)',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏≤‡∏£‡∏µ‡∏ô‡∏∏‡∏Å‡∏π‡∏•',
      '‡∏≠‡∏¢‡∏π‡πà‡∏ß‡∏á‡∏®‡πå‡∏ò‡∏£‡∏£‡∏°',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏™‡∏™‡∏±‡∏°‡∏ä‡∏±‡∏ç 1',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏™‡∏™‡∏±‡∏°‡∏ä‡∏±‡∏ç 2',
      '‡∏ß‡∏±‡∏î‡∏ó‡∏≠‡∏á‡∏ô‡∏û‡∏Ñ‡∏∏‡∏ì',
      '‡∏ß‡∏±‡∏î‡∏õ‡∏ó‡∏∏‡∏°‡∏°‡∏≤‡∏•‡∏±‡∏¢ 1',
      '‡∏ß‡∏±‡∏î‡∏õ‡∏ó‡∏∏‡∏°‡∏°‡∏≤‡∏•‡∏±‡∏¢ 2',
      '‡∏ß‡∏±‡∏î‡πÅ‡∏à‡πâ‡∏á 1',
      '‡∏ß‡∏±‡∏î‡πÅ‡∏à‡πâ‡∏á 2',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏∏‡∏ö‡∏•‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏° 1',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏∏‡∏ö‡∏•‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏° 2',
      '‡∏ß‡∏±‡∏î‡∏°‡∏´‡∏≤‡∏ß‡∏ô‡∏≤‡∏£‡∏≤‡∏° 1',
      '‡∏ß‡∏±‡∏î‡∏°‡∏´‡∏≤‡∏ß‡∏ô‡∏≤‡∏£‡∏≤‡∏° 2',
      '‡∏ß‡∏±‡∏î‡∏°‡∏ì‡∏µ‡∏ß‡∏ô‡∏≤‡∏£‡∏≤‡∏°',
      '‡∏®‡∏≤‡∏•‡πÄ‡∏¢‡∏≤‡∏ß‡∏ä‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß',
      '‡∏ß‡∏±‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå 1',
      '‡∏ß‡∏±‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå 2',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏µ 1',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏µ 2',
      '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ 1',
      '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ 2',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ö‡πá‡∏ç‡∏à‡∏∞‡∏°‡∏∞ 1',
      '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ö‡πá‡∏ç‡∏à‡∏∞‡∏°‡∏∞ 2'
    ]

  };

  /* ‡πÅ‡∏ó‡∏£‡∏Å select ‡∏´‡∏•‡∏±‡∏á input */
  communityInput.insertAdjacentElement('afterend', communitySelect);

  /* ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ï‡∏≤‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå ===== */
  window.updateCommunityByCenter = function (centerId) {

    const list = communitiesByCenter[centerId];

    if (list) {
      communityInput.style.display = 'none';
      communityInput.required = false;
      communityInput.value = '';

      communitySelect.style.display = 'block';
      communitySelect.innerHTML =
        '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏°‡∏ä‡∏ô --</option>' +
        list.map(c => `<option value="${c}">${c}</option>`).join('');
    } else {
      communitySelect.style.display = 'none';
      communitySelect.value = '';

      communityInput.style.display = 'block';
      communityInput.required = true;
    }
  };

  /* ===== ‡∏ï‡∏≠‡∏ô submit ‡πÇ‡∏≠‡∏ô‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ input ===== */
  const form = document.getElementById('surveyForm');
  form.addEventListener('submit', function () {
    if (communitySelect.style.display !== 'none') {
      communityInput.value = communitySelect.value;
    }
  });

});
</script>
<script>
/* ==================================================
   FIX ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°
   ‡πÉ‡∏ä‡πâ submit capture (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å submit ‡πÄ‡∏î‡∏¥‡∏°)
================================================== */
document.addEventListener('submit', function (e) {

  const form = e.target;
  if (!form || form.id !== 'surveyForm') return;

  const communityInput = document.getElementById('community');
  const communitySelect = document.getElementById('communitySelect');

  if (communityInput && communitySelect &&
      communitySelect.style.display !== 'none') {

    communityInput.value = communitySelect.value || '';
  }

}, true); // ‚≠ê true = capture phase
</script>
<script>
/* ==================================================
   HARD VALIDATION LOCK
   ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô = ‡∏´‡πâ‡∏≤‡∏°‡∏™‡πà‡∏á‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î (‡∏ó‡∏∏‡∏Å submit)
================================================== */
document.addEventListener('submit', function (e) {

  const form = e.target;
  if (!form || form.id !== 'surveyForm') return;

  const recorder = document.getElementById('recorderName');
  const phone = document.getElementById('phone');
  const animalType = document.getElementById('animalType');

  /* -------- ‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å -------- */
  if (!recorder || !recorder.value.trim()) {
    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å ‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / ‡∏ú‡∏π‡πâ‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•)');
    recorder?.focus();
    e.preventDefault();
    e.stopImmediatePropagation(); // ‚≠ê ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏±‡∏ß‡πÉ‡∏à
    return;
  }

  /* -------- ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ 10 ‡∏´‡∏•‡∏±‡∏Å -------- */
  if (!phone || !/^\d{10}$/.test(phone.value)) {
    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 10 ‡∏´‡∏•‡∏±‡∏Å');
    phone?.focus();
    e.preventDefault();
    e.stopImmediatePropagation();
    return;
  }

  /* -------- ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç / ‡πÅ‡∏°‡∏ß -------- */
  if (animalType.value === '‡∏™‡∏∏‡∏ô‡∏±‡∏Ç' || animalType.value === '‡πÅ‡∏°‡∏ß') {

    const pets = document.querySelectorAll('.pet-card');
    if (pets.length === 0) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á');
      e.preventDefault();
      e.stopImmediatePropagation();
      return;
    }

    for (let i = 0; i < pets.length; i++) {
      const card = pets[i];
      const no = i + 1;

      const v = cls => card.querySelector(cls)?.value?.trim();

      const base = [
        ['‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå', '.petName'],
        ['‡πÄ‡∏û‡∏®', '.gender'],
        ['‡∏™‡∏µ / ‡∏ï‡∏≥‡∏´‡∏ô‡∏¥', '.color'],
        ['‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô', '.sterilization'],
        ['‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤', '.rabies'],
        ['‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', '.raising'],
        ['‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', '.location']
      ];

      for (const [label, cls] of base) {
        if (!v(cls)) {
          alert(`‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà ${no} : ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å ${label}`);
          e.preventDefault();
          e.stopImmediatePropagation();
          return;
        }
      }

      if (!v('.ageYear') && !v('.ageMonth')) {
        alert(`‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà ${no} : ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏≤‡∏¢‡∏∏`);
        e.preventDefault();
        e.stopImmediatePropagation();
        return;
      }

      if (v('.rabies') === '‡πÄ‡∏Ñ‡∏¢‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤') {
        if (!v('.rabiesDate') ||
            !card.querySelector('.rabiesVetBox .vetSource')?.value) {
          alert(`‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà ${no} : ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö`);
          e.preventDefault();
          e.stopImmediatePropagation();
          return;
        }
      }

      if (v('.sterilization') === '‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏°') {
        if (!v('.contraceptiveDate') ||
            !card.querySelector('.contraceptiveVetBox .vetSource')?.value) {
          alert(`‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà ${no} : ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö`);
          e.preventDefault();
          e.stopImmediatePropagation();
          return;
        }
      }
    }
  }

}, true); // ‚≠ê capture phase
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° label
  document.querySelectorAll('label').forEach(label => {
    if (label.textContent.replace(/\s+/g, '').includes('‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•/‡∏ú‡∏π‡πâ‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•')) {
      label.textContent = '‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•/‡∏ú‡∏π‡πâ‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•(‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•)';
    }
  });

  // ‡∏Å‡∏£‡∏ì‡∏µ‡∏ö‡∏≤‡∏á‡∏ò‡∏µ‡∏°‡πÉ‡∏ä‡πâ placeholder ‡πÅ‡∏ó‡∏ô label
  const recorder = document.getElementById('recorderName');
  if (recorder && recorder.placeholder) {
    recorder.placeholder = '‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•/‡∏ú‡∏π‡πâ‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•(‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•)';
  }
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const citizenInput = document.getElementById('citizenId');
  if (!citizenInput) return;

  /* ===== ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå ===== */
  const wrap = document.createElement('div');
  wrap.style.margin = '15px 0';
  wrap.style.textAlign = 'center';

  wrap.innerHTML = `
    <label style="display:block;margin-bottom:8px;">
      ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
    </label>
    <img id="ownerPhotoPreview"
         src=""
         alt="preview"
         style="
           width:120px;
           height:120px;
           object-fit:cover;
           border-radius:50%;
           border:2px solid #2c3e90;
           display:none;
           margin-bottom:10px;
         ">
    <input type="file"
           id="ownerPhoto"
           accept="image/*"
           capture="environment">
  `;

  /* ===== ‡πÅ‡∏ó‡∏£‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå ===== */
  const ownerTitle = document.getElementById('ownerInfoTitle');
  if (ownerTitle) {
    ownerTitle.insertAdjacentElement('beforebegin', wrap);
  } else {
    citizenInput.insertAdjacentElement('beforebegin', wrap);
  }

  /* ===== preview ‡∏£‡∏π‡∏õ ===== */
  const fileInput = wrap.querySelector('#ownerPhoto');
  const preview = wrap.querySelector('#ownerPhotoPreview');

  fileInput.addEventListener('change', function () {
    const file = this.files[0];
    if (!file) return;

    if (!file.type.startsWith('image/')) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô');
      this.value = '';
      return;
    }

    const reader = new FileReader();
    reader.onload = function (e) {
      preview.src = e.target.result;
      preview.style.display = 'block';
    };
    reader.readAsDataURL(file);
  });
});
</script>
<script>
(function () {

  const originalFetch = window.fetch;

  window.fetch = async function (url, options) {

    if (!options || typeof options.body !== 'string') {
      return originalFetch.call(this, url, options);
    }

    try {

      const data = JSON.parse(options.body);

      /* =========================
         ‡πÅ‡∏ô‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ö‡πâ‡∏≤‡∏ô
      ==========================*/
      const homePhoneInput = document.getElementById('homePhone');
      if (homePhoneInput) {
        data.homePhone = homePhoneInput.value || '';
      }

      /* =========================
         ‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á
      ==========================*/
      const ownerFile = document.getElementById('ownerPhoto');
      if (ownerFile && ownerFile.files && ownerFile.files[0]) {
        const ownerBase64 = await readFile(ownerFile.files[0]);
        data.ownerPhotoBase64 = ownerBase64;
      }

      /* =========================
         ‚≠ê ‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß ‚≠ê
      ==========================*/
      if (data.pets && data.pets.length) {

        const cards = document.querySelectorAll('.pet-card');

        for (let i = 0; i < cards.length; i++) {

          const fileInput = cards[i].querySelector('.petPhoto');

          if (fileInput && fileInput.files && fileInput.files[0]) {
            data.pets[i].petPhotoBase64 =
              await compressImage(fileInput.files[0]);
          } else {
            data.pets[i].petPhotoBase64 = '';
          }

        }
      }

      options.body = JSON.stringify(data);

      return originalFetch.call(this, url, options);

    } catch (err) {
      return originalFetch.call(this, url, options);
    }
  };

  /* ---------- helper ---------- */

  function readFile(file) {
    return new Promise(resolve => {
      const reader = new FileReader();
      reader.onload = e => resolve(e.target.result);
      reader.readAsDataURL(file);
    });
  }

  function compressImage(file, maxWidth = 800, quality = 0.7) {
    return new Promise(resolve => {
      const img = new Image();
      const reader = new FileReader();

      reader.onload = e => img.src = e.target.result;

      img.onload = function () {
        const canvas = document.createElement('canvas');
        const scale = Math.min(maxWidth / img.width, 1);
        canvas.width = img.width * scale;
        canvas.height = img.height * scale;

        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

        resolve(canvas.toDataURL('image/jpeg', quality));
      };

      reader.readAsDataURL(file);
    });
  }

})();
</script>
<script>
/* ==================================================
   HARD LOCK : ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
================================================== */
document.addEventListener('submit', function (e) {

  const form = e.target;
  if (!form || form.id !== 'surveyForm') return;

  const photoInput = document.getElementById('ownerPhoto');

  if (!photoInput || !photoInput.files || photoInput.files.length === 0) {
    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á');
    photoInput?.focus();
    e.preventDefault();
    e.stopImmediatePropagation();
    return;
  }

}, true); // ‚≠ê capture phase
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const yearInput = document.getElementById('year');
  if (!yearInput) return;

  yearInput.value = '2569';
  yearInput.readOnly = true;
  yearInput.style.background = '#f0f0f0';
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  ['addrNo','road','subdistrict','district','province'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.required = true;
  });
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const animalType = document.getElementById('animalType');
  const otherBox = document.getElementById('otherAnimalBox');
  const otherType = document.getElementById('otherAnimalType');
  const otherQty = document.getElementById('otherAnimalQty');

  const petQtyInput = document.getElementById('petQty');
  const petList = document.getElementById('petList');

  animalType.addEventListener('change', function () {

    if (this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏') {

      /* ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÜ */
      otherBox.style.display = 'block';
      otherType.required = true;
      otherQty.required = true;

      /* ‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà 1 2 3 */
      petQtyInput.value = 0;
      petList.innerHTML = '';
      petQtyInput.disabled = true;
      petList.style.display = 'none';

    } else {

      /* ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ */
      otherBox.style.display = 'none';
      otherType.required = false;
      otherQty.required = false;
      otherType.value = '';
      otherQty.value = '';

      petQtyInput.disabled = false;
      petList.style.display = 'block';
    }

  });

});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const animalType = document.getElementById('animalType');
  const otherBox = document.getElementById('otherAnimalBox');
  const otherType = document.getElementById('otherAnimalType');
  const otherQty = document.getElementById('otherAnimalQty');

  const petQtyBox = document.getElementById('petQtyBox');
  const petQtyInput = document.getElementById('petQty');
  const petList = document.getElementById('petList');

  animalType.addEventListener('change', function () {

    if (this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏') {

      /* ===== ‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ===== */
      otherBox.style.display = 'block';
      otherType.required = true;
      otherQty.required = true;

      /* ‚ùå ‡∏ã‡πà‡∏≠‡∏ô ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á + pet-card */
      petQtyBox.style.display = 'none';
      petQtyInput.value = 0;
      petQtyInput.disabled = true;
      petList.innerHTML = '';
      petList.style.display = 'none';

    } else {

      /* ===== ‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ ===== */
      otherBox.style.display = 'none';
      otherType.required = false;
      otherQty.required = false;
      otherType.value = '';
      otherQty.value = '';

      petQtyBox.style.display = 'block';
      petQtyInput.disabled = false;
      petList.style.display = 'block';
    }

  });

});
</script>
<script>
/* ==================================================
   ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏∏‡∏ô‡∏±‡∏Ç/‡πÅ‡∏°‡∏ß)
   + ‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î‡∏£‡∏π‡∏õ
   + ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
   + ‡πÅ‡∏ô‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ payload ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
   ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°
================================================== */

(function(){

  /* ===== 1. ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç/‡πÅ‡∏°‡∏ß ===== */
  document.addEventListener('change', function(e){

    if(e.target.id === 'animalType'){
      togglePetPhotoBox();
    }

    if(e.target.classList.contains('petPhoto')){
      previewPetPhoto(e.target);
    }

  });

  function togglePetPhotoBox(){
    const type = document.getElementById('animalType')?.value;
    const show = (type === '‡∏™‡∏∏‡∏ô‡∏±‡∏Ç' || type === '‡πÅ‡∏°‡∏ß');

    document.querySelectorAll('.pet-card').forEach(card=>{
      let box = card.querySelector('.petPhotoBox');

      if(!box){
        box = createPhotoBox();
        card.appendChild(box);
      }

      box.style.display = show ? 'block' : 'none';
    });
  }

  function createPhotoBox(){
    const div = document.createElement('div');
    div.className = 'petPhotoBox';
    div.style.marginTop = '10px';
    div.style.display = 'none';

    div.innerHTML = `
      <label>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</label>
      <img class="petPhotoPreview"
           style="width:120px;height:120px;object-fit:cover;border-radius:8px;display:none;margin-bottom:6px;">
      <input type="file"
             class="petPhoto"
             accept="image/*"
             capture="environment">
    `;
    return div;
  }

  function previewPetPhoto(input){
    const file = input.files[0];
    if(!file || !file.type.startsWith('image/')) return;

    const reader = new FileReader();
    const preview = input.closest('.petPhotoBox')
                         .querySelector('.petPhotoPreview');

    reader.onload = e=>{
      preview.src = e.target.result;
      preview.style.display = 'block';
    };
    reader.readAsDataURL(file);
  }

  /* ===== 2. ‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î‡∏£‡∏π‡∏õ ===== */
  function compressImage(file, maxWidth = 800, quality = 0.7){
    return new Promise(resolve=>{
      const img = new Image();
      const reader = new FileReader();

      reader.onload = e => img.src = e.target.result;

      img.onload = function(){
        const canvas = document.createElement('canvas');
        const scale = Math.min(maxWidth / img.width, 1);
        canvas.width = img.width * scale;
        canvas.height = img.height * scale;

        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

        resolve(canvas.toDataURL('image/jpeg', quality));
      };

      reader.readAsDataURL(file);
    });
  }

  /* ===== 3. ‡∏î‡∏±‡∏Å fetch ‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡πÄ‡∏Ç‡πâ‡∏≤ payload ===== */
  const originalFetch = window.fetch;

  window.fetch = async function(url, options){

    if(!options || typeof options.body !== 'string'){
      return originalFetch.call(this, url, options);
    }

    try{
      const data = JSON.parse(options.body);

      if(data.pets && data.pets.length){

        const cards = document.querySelectorAll('.pet-card');

        for(let i=0;i<cards.length;i++){
          const fileInput = cards[i].querySelector('.petPhoto');

          if(fileInput && fileInput.files[0]){
            data.pets[i].petPhotoBase64 =
              await compressImage(fileInput.files[0]);
          }else{
            data.pets[i].petPhotoBase64 = '';
          }
        }
      }

      options.body = JSON.stringify(data);

      return originalFetch.call(this, url, options);

    }catch(err){
      return originalFetch.call(this, url, options);
    }
  };

  /* ===== 4. HARD LOCK ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏£‡∏π‡∏õ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏∏‡∏ô‡∏±‡∏Ç/‡πÅ‡∏°‡∏ß) ===== */
  document.addEventListener('submit', function(e){

    const form = e.target;
    if(!form || form.id !== 'surveyForm') return;

    const type = document.getElementById('animalType')?.value;
    if(type !== '‡∏™‡∏∏‡∏ô‡∏±‡∏Ç' && type !== '‡πÅ‡∏°‡∏ß') return;

    const cards = document.querySelectorAll('.pet-card');

    for(let i=0;i<cards.length;i++){
      const fileInput = cards[i].querySelector('.petPhoto');
      if(!fileInput || !fileInput.files.length){
        alert(`‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà ${i+1} : ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û`);
        e.preventDefault();
        e.stopImmediatePropagation();
        return;
      }
    }

  }, true);

})();
</script>
 <script>
/* ==================================================
   FIX: ‡∏£‡∏π‡∏õ‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ pet-card ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á
   ‡πÅ‡∏Å‡πâ‡πÇ‡∏î‡∏¢ Hook ‡∏´‡∏•‡∏±‡∏á syncPetList()
================================================== */

(function(){

  function ensurePhotoBox(){
    const type = document.getElementById('animalType')?.value;
    if(type !== '‡∏™‡∏∏‡∏ô‡∏±‡∏Ç' && type !== '‡πÅ‡∏°‡∏ß') return;

    document.querySelectorAll('.pet-card').forEach(card=>{
      if(!card.querySelector('.petPhotoBox')){
        const div = document.createElement('div');
        div.className = 'petPhotoBox';
        div.style.marginTop = '10px';

        div.innerHTML = `
          <label>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</label>
          <img class="petPhotoPreview"
               style="width:120px;height:120px;object-fit:cover;border-radius:8px;display:none;margin-bottom:6px;">
          <input type="file"
                 class="petPhoto"
                 accept="image/*"
                 capture="environment">
        `;

        card.appendChild(div);
      }
    });
  }

  /* üî• Hook ‡πÄ‡∏Ç‡πâ‡∏≤ syncPetList */
  const oldSync = window.syncPetList;
  window.syncPetList = function(){
    if(oldSync) oldSync();
    setTimeout(ensurePhotoBox, 50);
  };

})();
</script>
<script>
/* =====================================================
   UNIVERSAL PET PHOTO SYSTEM
   ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå
   ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç/‡πÅ‡∏°‡∏ß
   ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°
===================================================== */
(function(){

  /* ---------------------------
     ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ‡πÉ‡∏ô pet-card
  ----------------------------*/
  function addPhotoBoxToCard(card){
    if(card.querySelector('.petPhotoBox')) return;

    const div = document.createElement('div');
    div.className = 'petPhotoBox';
    div.style.marginTop = '10px';

    div.innerHTML = `
      <label>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</label>
      <img class="petPhotoPreview"
           style="width:120px;height:120px;object-fit:cover;border-radius:8px;display:none;margin-bottom:6px;">
      <input type="file"
             class="petPhoto"
             accept="image/*"
             capture="environment">
    `;

    card.appendChild(div);
  }

  /* ---------------------------
     preview ‡∏£‡∏π‡∏õ
  ----------------------------*/
  document.addEventListener('change', function(e){
    if(e.target.classList.contains('petPhoto')){
      const file = e.target.files[0];
      if(!file || !file.type.startsWith('image/')) return;

      const reader = new FileReader();
      const preview = e.target.closest('.petPhotoBox')
                               .querySelector('.petPhotoPreview');

      reader.onload = function(ev){
        preview.src = ev.target.result;
        preview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    }
  });

  /* ---------------------------
     ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç ‡πÅ‡∏°‡∏ß ‡πÇ‡∏Ñ ‡∏Ø‡∏•‡∏Ø
  ----------------------------*/
  function syncNormalPetPhotos(){
    document.querySelectorAll('.pet-card').forEach(addPhotoBoxToCard);
  }

  const observer = new MutationObserver(syncNormalPetPhotos);
  observer.observe(document.body, {childList:true, subtree:true});

  document.addEventListener('change', function(e){
    if(e.target.id === 'animalType'){
      setTimeout(syncNormalPetPhotos,100);
    }
  });

  /* ---------------------------
     ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö "‡∏≠‡∏∑‡πà‡∏ô‡πÜ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏"
  ----------------------------*/
  const otherQty = document.getElementById('otherAnimalQty');
  const otherBox = document.getElementById('otherAnimalBox');

  if(otherQty){
    otherQty.addEventListener('input', function(){

      let container = document.getElementById('otherPhotoContainer');
      if(!container){
        container = document.createElement('div');
        container.id = 'otherPhotoContainer';
        container.style.marginTop = '10px';
        otherBox.appendChild(container);
      }

      const qty = parseInt(this.value || 0);

      while(container.children.length < qty){
        const div = document.createElement('div');
        div.style.marginBottom = '10px';
        div.innerHTML = `
          <label>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà ${container.children.length+1}</label>
          <input type="file"
                 class="otherPetPhoto"
                 accept="image/*"
                 capture="environment">
        `;
        container.appendChild(div);
      }

      while(container.children.length > qty){
        container.removeChild(container.lastChild);
      }

    });
  }

  /* ---------------------------
     HARD LOCK ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç/‡πÅ‡∏°‡∏ß
  ----------------------------*/
  document.addEventListener('submit', function(e){

    const form = e.target;
    if(!form || form.id !== 'surveyForm') return;

    const type = document.getElementById('animalType')?.value;

    if(type === '‡∏™‡∏∏‡∏ô‡∏±‡∏Ç' || type === '‡πÅ‡∏°‡∏ß'){
      const cards = document.querySelectorAll('.pet-card');

      for(let i=0;i<cards.length;i++){
        const fileInput = cards[i].querySelector('.petPhoto');
        if(!fileInput || !fileInput.files.length){
          alert(`‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà ${i+1} : ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û`);
          e.preventDefault();
          e.stopImmediatePropagation();
          return;
        }
      }
    }

  }, true);

})();
</script>
<script>
/* ==================================================
   FINAL FETCH OVERRIDE (‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏à‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö)
   ‡πÅ‡∏ô‡∏ö:
   - homePhone
   - ownerPhoto
   - petPhoto ‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß
================================================== */
(function () {

  const originalFetch = window.fetch;

  window.fetch = async function (url, options) {

    if (!options || typeof options.body !== 'string') {
      return originalFetch.call(this, url, options);
    }

    try {

      const data = JSON.parse(options.body);

      /* ===== ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ö‡πâ‡∏≤‡∏ô ===== */
      const homePhone = document.getElementById('homePhone');
      if (homePhone) {
        data.homePhone = homePhone.value || '';
      }

      /* ===== ‡∏£‡∏π‡∏õ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ===== */
      const ownerFile = document.getElementById('ownerPhoto');
      if (ownerFile && ownerFile.files && ownerFile.files[0]) {
        data.ownerPhotoBase64 = await toBase64(ownerFile.files[0]);
      }

      /* ===== ‡∏£‡∏π‡∏õ‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß ===== */
      if (data.pets && data.pets.length) {

        const cards = document.querySelectorAll('.pet-card');

        for (let i = 0; i < cards.length; i++) {

          const fileInput = cards[i].querySelector('.petPhoto');

          if (fileInput && fileInput.files && fileInput.files[0]) {
            data.pets[i].petPhotoBase64 =
              await compressImage(fileInput.files[0]);
          } else {
            data.pets[i].petPhotoBase64 = '';
          }

        }
      }

      options.body = JSON.stringify(data);
      return originalFetch.call(this, url, options);

    } catch (err) {
      console.error(err);
      return originalFetch.call(this, url, options);
    }
  };

  function toBase64(file) {
    return new Promise(resolve => {
      const reader = new FileReader();
      reader.onload = e => resolve(e.target.result);
      reader.readAsDataURL(file);
    });
  }

  function compressImage(file, maxWidth = 800, quality = 0.7) {
    return new Promise(resolve => {
      const img = new Image();
      const reader = new FileReader();

      reader.onload = e => img.src = e.target.result;

      img.onload = function () {
        const canvas = document.createElement('canvas');
        const scale = Math.min(maxWidth / img.width, 1);

        canvas.width = img.width * scale;
        canvas.height = img.height * scale;

        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

        resolve(canvas.toDataURL('image/jpeg', quality));
      };

      reader.readAsDataURL(file);
    });
  }

})();
</script>
<script>
/* ==========================================
   AUTO DETECT pet-card ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ
   FINAL VERSION (‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
========================================== */

(function(){

  function addPhotoBox(card){

    if(card.querySelector('.petPhotoBox')) return;

    const div = document.createElement('div');
    div.className = 'petPhotoBox';
    div.style.marginTop = '10px';

    div.innerHTML = `
      <label>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</label>
      <img class="petPhotoPreview"
           style="width:120px;height:120px;object-fit:cover;border-radius:8px;display:none;margin-bottom:6px;">
      <input type="file"
             class="petPhoto"
             accept="image/*"
             capture="environment">
    `;

    card.appendChild(div);

    const input = div.querySelector('.petPhoto');
    const preview = div.querySelector('.petPhotoPreview');

    input.addEventListener('change', function(){
      const file = this.files[0];
      if(!file || !file.type.startsWith('image/')) return;

      const reader = new FileReader();
      reader.onload = e=>{
        preview.src = e.target.result;
        preview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    });
  }

  const observer = new MutationObserver(function(){

    const type = document.getElementById('animalType')?.value;
    if(type !== '‡∏™‡∏∏‡∏ô‡∏±‡∏Ç' && type !== '‡πÅ‡∏°‡∏ß') return;

    document.querySelectorAll('.pet-card').forEach(card=>{
      addPhotoBox(card);
    });

  });

  observer.observe(document.body,{
    childList:true,
    subtree:true
  });

})();
</script>
 
</body>

</html>
